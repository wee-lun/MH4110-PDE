\newpage
\section{Waves and Diffusions}
\subsection{The Wave Equation}

We have defined wave equation is the previous chapter. Note that if we take the wave equation on $\R$, it takes the form of 
\[u_{tt} = c^2 u_{xx}\]
where $x\in \R$ is a variable of reals, and the constant $c>0$ is the wave speed. We will study its solution in this part.

\underline{Method 1: Factorization of the differential operator}

Note that we can rewrite the equation into 
\[u_{tt}-c^2u_{xx} = \br{\diffp{}{t} - c\diffp{}{x}}\br{\diffp{}{t} + c\diffp{}{x}}u = 0\]
where what we done is to factorize the differential operators.

Next, define 
\begin{align*}
    v &= \br{\diffp{}{t} + c\diffp{}{x}}u \\
    &= u_t + cu_x
\end{align*}
The wave equation can then be rewritten as 
\[\br{\diffp{}{t} - c\diffp{}{x}}v = 0 \implies v_t - cv_x = 0\]
This is a first-order linear PDE, which its solution is fully known.

By the method of characteristic, we see that 
\[v(x,t) = h(x+ct)\]
where $h$ is an arbitrary function. Recovering $v$ we see 
\[u_t + cu_x = h(x+ct)\]
This is again a first-order linear PDE, except that it is inhomogeneous. To solve this, we have to solve its general solution and particular solution.

Its general solution is $u=g(x-ct)$ where $g$ is an arbitrary function. For the particular solution, we can verify that $u= f(x+ct)$ is a particular solution:
\[h(x+ct) = u_t + cu_x = cf'(x+ct) + cf'(x+ct) = 2c f'(x+ct)\]
where we see we can take function $f$ so that $f'(x+ct) = \frac{1}{2c}h(x+ct)$.

Therefore the solution is 
\[u(x,t) = f(x+ct) + g(x-ct)\]
where $f$ and $g$ are arbitrary functions.

\medskip 

\begin{ex}
    Suppose given $u_{xx} - 3u_{xt}-4u_{tt}=0$. This can be viewed as the same to factorize 
    \[x^2 - 3xt -4t^2=0\]
    which is $(x-4t)(x+t)=0$. Translating back, the given PDE can be factorized as 
    \[(\partial_x - 4\partial_t)(\partial_x + \partial_t)u=0\]
    To continue solving the PDE, simply let $v=(\partial_x + \partial_t)u$ so that the PDE can be rewritten as 
    \[v_x - 4v_t=0\]
    The remaining process to continue the solution is the same as described in the above paragraph, the details are omitted here.
\end{ex}

\underline{Method 2: Characteristic Coordinates}

We can introduce the characteristic coordinates 
\[\xi = x+ct \quad \text{and}\quad \eta = x-ct\]
By chain rule, we obtain 
\[\diffp{}{x} = \diffp{}{\xi} + \diffp{}{\eta} \quad \text{and} \quad \diffp{}{t} = c\diffp{}{\xi} - c\diffp{}{\eta}\]
as well as 
\[\diffp[2]{}{x} = \diffp[2]{}{\xi} + 2\diffp{}{{\xi}{\eta}} + \diffp[2]{}{\eta} \quad \text{and} \quad \diffp[2]{}{t} = c^2 \br{\diffp[2]{}{\xi} - 2\diffp{}{{\xi}{\eta}} + \diffp[2]{}{\eta}}\]
Substituting these into wave equation we get 
\[u_{tt} -c^2 u_{xx} = -4c^2u_{\xi\eta} = 0\implies u_{\xi\eta} = 0\]
Solving out, we get solution 
\[u = f(\xi) + g(\eta) = f(x+ct) + g(x-ct)\]
where $f$ and $g$ are two arbitrary functions.

\medskip 

\begin{re}
    The above methods actually suggest that the wave equation has two families of characteristic lines: $x\pm ct = \text{constant}$. As the time $t$ increases:
    \begin{itemize}
        \item $g(x-ct)$ is a wave that travels to the right at speed $c$.
        \item $f(x+ct)$ is a wave that travels to the left at speed $c$.
    \end{itemize}
\end{re}

As wave equation is motivated from physical phenomenon, it is natural to discuss how to solve its IVP. Suppose given the initial condition 
\[u(x,0) = \phi(x) \quad \text{and} \quad u_t(x,0) = \psi(x) \quad \text{and} \quad -\infty<x<\infty\]
where $\phi$ and $\psi$ are arbitrary functions of single variable $x$, we want to give the exact solution to the wave equation. Since the solution $u = f(x+ct) + g(x-ct)$ is known, by substituting specific $x$ and/or $t$, and taking derivative when necessarily, we obtain:
\[u(x,0) = f(x) + g(x) = \phi(x)\implies f'(x) + g'(x) = \phi'(x)\]
and 
\[u_t(x,0) = cf'(x) -cg'(x) = \psi(x)\]
These two equations give 
\[\left\{
     \begin{array}{ll}
        f'(x) &= \frac{1}{2} \phi'(x) + \frac{1}{2c} \psi(x)\\
        g'(x) &= \frac{1}{2} \phi'(x) - \frac{1}{2c} \psi(x)
    \end{array}
\right.\]
Integrating, we get 
\[\left\{
     \begin{array}{ll}
        f(x) &= \frac{1}{2} \phi(x) + \frac{1}{2c} \int_0^x \psi(s) ds + A\\
        g(x) &= \frac{1}{2} \phi(x) - \frac{1}{2c} \int_0^x \psi(s) ds + B
    \end{array}
\right.\]
Taking sum of two equations, we get $f(x) + g(x) = \phi(x) + (A+B)$. However, by comparing with the initial condition $u(x,0) = f(x) + g(x) = \phi(x)$, we see that $A+B=0$.

Lastly, substitute the obtained $f$ and $g$ into the solution $u(x,t) = f(x+ct) + g(x-ct)$ and simply into 
\[u(x,t) = \frac{1}{2}[\phi(x+ct) + \phi(x-ct)] + \frac{1}{2c}\int_{x-ct}^{x+ct} \psi(s) ds\]
This is the solution formula for the IVP of wave equation. In particular, the setup of the IVP is called \textit{Cauchy Problem}, and the obtained solution formula is called the \textit{d'Alambert Formula}.

\medskip 

\begin{re} [General d'Alambert Formula]
    If the given IVP is not starting at $t=0$, say $t=t_0 >0$, one can perform a change of variable by setting $t'=t-t_0$, so that the d'Alambert Formula can be applied to solve the IVP. In general, the formula for solving such IVP is 
    \[u(x,t) = \frac{1}{2}[\phi(x+c(t-t_0)) + \phi(x-c(t-t_0))] + \frac{1}{2c}\int_{x-c(t-t_0)}^{x+c(t-t_0)}\psi(s) ds\]
\end{re}

\subsection{Causality and Energy}
We have discussed d'Alambert formula previously. Note that $u(x,t)$ depends on the values of $\phi$ and $\psi$. In particular, the value $u(x,t)$ is affected by the following:
\begin{itemize}
    \item value of $\phi$ at point $(x-ct,0)$
    \item value of $\phi$ at point $(x+ct,0)$
    \item value of $\psi$ on the interval $[x-ct, x+ct]$.
\end{itemize}
The interval $[x-ct,x+ct]$ seems important as all informations are contained here. 

\medskip 

\begin{defn} [Interval of Dependence, Domain of Dependence]
    The interval of dependece for point $(x,t)$ is defined to be the interval $[x-ct, x+ct]$. The domain of dependence (or the past history) of the point $(x,t)$ refers to the triangular region with vertices $(x-ct,0), (x-ct,0),$ and $(x,t)$
\end{defn}
 
\begin{center}
    \includegraphics[scale=0.5]{interval of dependence.png}
\end{center}

\begin{re}
    The triangular region is called the past history of point $(x,t)$ for a reason. Consider that at the moment when the time equals to $t$, and we are in position $x$. This makes that everything within the triangular region representing 'the past' from when the time is $t$, since the second coordinate of all point within the triangular region is smaller than $t$. 

    Another physical interpretation of the triangular region is that, only the points inside the triangular region affects the value of $u(x,t)$, and hence the name domain of dependence. If something outside the region is altered, it won't affect the value of $u(x,t)$.
\end{re}

We can change our perspective by asking
\begin{quote}
    Suppose given a starting point $(x_0,0)$, for which point $(x,t)$ where the value of $u(x,t)$ will be affected by the given point?
\end{quote}
Clearly, many points will be affected, and these points are exactly the points within the shaded region in the following diagram:
\begin{center}
    \includegraphics[scale = 0.5]{region of influence.png}
\end{center}

\begin{minipage} [t] {0.6 \textwidth}
    \begin{defn} [Region of Influence]
        The region of influence of the point $(x_0, 0)$ is defined to be the shaded region above. 
    \end{defn}

    \medskip

    The value $u(x,t)$ is affected by $(x_0, 0)$ if and only if
    \[x-ct\leq x_0 \leq x+ct\]
    given that the speed of the wave is bounded by $c$.
    
    \medskip 

    \begin{re} [Minkowski's light cone]
        Since light has the property of wave-particle duality, photons obey the wave equation. The Minkowski's light cone, which illustrates causality from past and future, is related by the above concept.
    \end{re}
\end{minipage}
\begin{minipage}[t]{0.4 \textwidth} % Image occupies 35% of the width
        \vspace{0pt} % Aligns the top of the image with the top of the text
        \centering
        \includegraphics[scale = 0.5]{lightcone.png}
\end{minipage}

\medskip 

\begin{defn} [Kinetic Energy, Potential Energy, and Total Energy]
    Consider an infinite string with constant linear density $\rho$ and tension magnitude $T$. Inheritting the above notation: 
    \begin{itemize}
        \item The kinetic energy at time $t$ is defined as \[E_K(t) = \frac{1}{2}\rho \int_{-\infty}^\infty u_t^2(x,t)\ dx\]
        \item The potential energy at time $t$ is defined as \[E_P(t) = \frac{1}{2}T\int_{-\infty}^\infty u_x^2(x,t)\ dx\]
    \end{itemize}
    The total energy at time $t$ is just the sum of the kinetic energy and potential energy, both at time $t$:
    \[E(t) = \frac{1}{2}\int_{-\infty}^{\infty}(\rho u_t^2 + T u_x^2)\ dx\]
\end{defn}

\begin{re} [Conservation of Energy]
    It is well-known that energy is conserved in a closed system. Mathematically, it means that the rate of change of total energy is $0$. Thus, showing the conservation of energy is equivalent to showing that $E'(t) = 0$. 

    So, we first obtain 
    \[E'(t) = \int_{-\infty}^\infty (\rho u_t u_{tt} + T u_x u_{xt})\ dx\]
    Note that the wave equation gives $u_{tt} = c^2 u_{xx}$, where expanding out $c=\sqrt{\frac{T}{\rho}}$ we see that $\rho u_{tt} = T u_{xx}$. Substituting we get 
    \[E'(t) = \int_{-\infty}^\infty (T u_t u_{xx} + T u_x u_{xt})\ dx = T\int_{-\infty}^\infty (u_t u_{xx} + u_x u_{xt})\ dx\]
    Note that $u_t u_{xx} + u_x u_{xt} = \diffp{}{x}(u_tu_x)$, again substituting we get 
    \[E'(t) = T\int_{-\infty}^\infty \diffp{}{x}(u_tu_x)\ dx\]
    By Fundamental Theorem of Calculus, it can be evaluated as 
    \[E'(t) = T u_t u_x \Big |^\infty_{-\infty}\]
    Of course, we assume that the energy is finite, so the wave flatten and rest eventually if we moved far enough away from the source $x=0$. Recall that $u_t$ represents velocity and $u_x$ represents the slope of the wave. At $x=\pm \infty$, the string is now flat and still, which implies $u_x = 0$ and $u_t = 0$ respectively. Thus 
    \[ E'(t) = T u_t u_x \Big |^\infty_{-\infty} = 0 - 0 = 0 \]
\end{re}

The above can be summarized as follow:

\medskip 

\begin{thm} [Conservation of Energy and IVP]
    Adapting the same notation, we see that 
    \[E(t) = \text{constant}\quad \forall t\geq 0\]
    In addition, suppose given IVP $u(x,0) = \phi(x)$ and $u_t(x,0)=\psi(x)$, then 
    \[E(t) = E(0) = \frac{1}{2}\int_{-\infty}^\infty \br{\rho\psi^2(x) + T(\phi'(x))^2}\ dx\]
\end{thm}

\subsection{The Diffusion Equation}

The goal here is to solve the diffusion equation:
\[u_t = ku_{xx}\]
and obtain a solution formula, depending on the given initial data $u(x,0) = \phi(x)$. This is more difficult to solve comparing to the wave equation. The strategy is as follow:
\begin{enumerate}
    \item Show the uniqueness of the solution.
    \item Construct a solution to the problem.
\end{enumerate}
We first give a theorem without proof:

\medskip 

\begin{thm} [Weak Maximum Principle]
    If $u(x,t)$ satisfies the diffusion equation $u_t = ku_{xx}$ in a rectangle $D = \sbr{(x,t): 0\leq x\leq \ell,\ 0\leq t\leq T}$ in space-time, then the maximum value of $u(x,t)$ is achieved either initially at $t=0$, or on the lateral sides, i.e. $x=0$ or $x= \ell$.
\end{thm}
In other words, denote the union of the left, bottom, and right boundaries as:
\[\Gamma:= \sbr{(x,0):0\leq x\leq \ell}\cup \sbr{(0,t):0\leq t\leq T} \cup \sbr{(\ell,t):0\leq t\leq T}\]
Then 
\[\max_{(x,t)\in \Gamma} u(x,t) = \max_{(x,t)\in D} u(x,t)\]
The notation of $\Gamma$ is used in the later proof as well. In $x-t$ coordinate system, the union $\Gamma$ of boundaries looks like this:
\begin{center}
    \includegraphics[scale = 0.3]{max principle.png}
\end{center}

\medskip 

\begin{re} \hfill
    \begin{enumerate}
        \item The Strong Maximum Principle says that, the maximum \textit{can and only can} achieved at $\Gamma$.
        \item Note that Maximum Principle also implies Minimum Principle by applying it to the function $-u(x,t)$ by noting that $(-u)_t = k(-u)_{xx}$ and utilize the identity
        \[\min \sbr{u(x,t)} = - \max \sbr{-u(x,t)}\]
        \item From physical perspective, if applying to heat equation, the principle says that: 
        \begin{quote}
            The highest temperature in the interior body cannot exceed the highest initial temperature, or the highest temperature on the boundary.
        \end{quote}
    \end{enumerate}
\end{re}

We now show the uniqueness:

\medskip

\begin{thm} [Uniqueness of Dirichlet Problem for Diffusion Equation]
    Consider the diffusion equation with Dirichlet boundary conditions:
    \[\begin{cases}
        u_t - ku_{xx} &= f(x,t)\ , 0<x<\ell, t>0\\
        u(x,0) &= \phi(x)\ \ \ , 0<x<\ell\\
        u(0,t) &= g(t) \ \ \ \ , u(\ell,t) = h(t)
    \end{cases}\]
    where $f,\phi,g,h$ are given functions. Then the above equation has unique solution.
\end{thm} 

\begin{proof} [Proof using Maximum Principle]
    Suppose that there are two solutions $u_1(x,t)$ and $u_2(x,t)$. Let $w:=u_1 - u_2$, then $w$ satisfies the homogenours equation with zero initial-boundary conditions:
    \begin{equation} \label{eqn: proof max principle}
        \begin{cases}
        w_t - kw_{xx} &= 0 \quad , 0<x<\ell, t>0\\
        w(x,0) &= 0 \quad , 0<x<\ell\\
        w(0,t) &= 0 \quad, w(\ell,t) = 0
        \end{cases}
    \end{equation}
    For any $T>0$, define the rectangle $D = \sbr{(x,t):0\leq x\leq \ell, 0\leq t\leq T}$. Since $w$ satisfeis the diffusion equation in the defined rectangle $D$, by Maximum Principle we see that 
    \[w(x,t) \leq \max_{(x',t')\in \Gamma} w(x',t')\quad \forall(x,t)\in D\]
    Note that for any $(x',t')\in \Gamma$ it takes the form of $(x',0)$, $(0,t')$, or $(\ell,T)$, which by Equation (\ref{eqn: proof max principle}) we see that $w(x',t')=0$ regardless of which form. Together, we see that 
    \[w(x,t)\leq 0\quad \forall(x,t)\in D\]
    Similarly, we can show using Minimum Principle that 
    \[w(x,t) \geq \min_{(x',t')\in \Gamma} w(x',t') =0 \quad \forall (x,t)\in D\]
    This shows that $u_1(x,t)-u_2(x,t) = w(x,t) = 0$, implying that $u_1 (x,t) = u_2(x,t)$ for all $0<x<\ell$ and all $t>0$. Thus the solution is unique.
\end{proof}

\begin{proof} [Proof using Energy Method]
    Suppose that there are two solutions $u_1(x,t)$ and $u_2(x,t)$. Let $w:=u_1 - u_2$, then $w$ satisfies the homogenours equation with zero initial-boundary conditions:
    \begin{equation} \label{eqn: proof max principle}
        \begin{cases}
        w_t - kw_{xx} &= 0 \quad , 0<x<\ell, t>0\\
        w(x,0) &= 0 \quad , 0<x<\ell\\
        w(0,t) &= 0 \quad, w(\ell,t) = 0
        \end{cases}
    \end{equation}
    The energy of $w$ at time $t$ is defined as 
    \[E[w](t) = \frac{1}{2}\int_0^\ell [w(x,t)]^2\ dx\]
    which is non-negative. Note that the initial condition $w(x,0)=0$ implies $E[w](0)=0$. Differentiating the energy w.r.t. time $t$, we get 
    \[\diff{E}{t} = \int_0^\ell ww_t\ dx\]
    Note diffusion equation says $w_t = kw_{xx}$, substituting we get 
    \[\diff{E}{t} = k\int_0^\ell ww_{xx}\ dx\]
    We can rewrite the integrand by noticing $ww_{xx} = \diffp{}{x}(ww_x)-w_x^2$, and deriving it to get:
    \begin{align*}
        \diff{E}{t} &= k\int_0^\ell ww_{xx}\ dx \\
        &= \int_0^\ell k\br{\diffp{}{x}(ww_x)-w_x^2}\ dx \\
        &=k[w(x,t)w_x(x,t)]^{x=\ell}_{x=0} - \int_{0}^{\ell}w_x^2 dx\\
        &\leq k[w(x,t)w_x(x,t)]^{x=\ell}_{x=0}
    \end{align*}
    where the last inequality is obtained by noting that $\int_{0}^{\ell}w_x^2$ is non-negative. Lastly, since $w(0,t)=0$ ad $w(\ell,t)=0$, thus $k[w(x,t)w_x(x,t)]^{x=\ell}_{x=0}=0$. Together we have 
    \[\diff{E}{t}\leq 0\]
    This shows that $E[w](t)$ is a decreasing quantity. By the definition of decreasing, for all $t$ we have 
    \[0\leq E[w](t) \leq E[w](0) = 0\]
    which forces that $E[w](t) = 0$. By definition of $E$, it implies that $w=0$ and thus $u_1 = u_2$. Therefore the solution is unique.
\end{proof}

\medskip 

\begin{ex}
    Consider the diffusion equation $u_t = u_xx$ with $(x,t)\in D:= \sbr{(x,t):0<x<\ell, t>0}$ with boundary conditions:
    \[u(0,t)=u(\ell,t)=0 \quad \text{and} \quad u(x,0) = 4x(\ell-x)\]
    We want to show that $0<u(x,t)<\ell^2$ for all $(x,t)\in D$. By Maximum Principle, the maximum of $u$ appears at the boundary $\Gamma$. The given condition $u(0,t) = u(\ell,t)=0$ implies that the maximum does not occur on the lateral sides, since $u(x,0)=4x(\ell-x)$ is greater than $0$ at some $x$. It is easy to justify that the maximum of $4x(\ell-x)$ occurs at $x=\ell/2$, where $u(\ell/2,0)=\ell^2$. Therefore by Maximum Principle we have $u(x,t)<\ell^2$ for all $(x,t)\in D$. 
    
    On the other hand, by Minimum Principle, the minimum of $u(x,t)$ must be achieved in $\Gamma$. Since $0\leq x\leq \ell$ in $\Gamma$, so $u(x,0)=4x(\ell-x)>0$. But $u(0,t)=u(\ell,t)=0$, thus $0$ is the minimum value by Minimum Principle. Together $u(x,t)>0$ for all $(x,t)\in D$.

    Next, we use the energy method to show that $\int_0^\ell u^2\ dx$ is a strictly decreasing function of $t$. Define 
    \[w(t) := \int_0^\ell u^2(x,t)\ dx\]
    It is equivalent to show that $\diff{}{t} w(t)<0$. Taking derivative w.r.t. $t$ we obtain:
    \[\diff{w}{t} = \int_{0}^{\ell} 2uu_t\ dx = 2\int_{0}^{\ell} uu_{xx}\ dx\]
    where the last equality is obatined by performing substitution by the given diffusion equation $u_t = u_xx$. Integration by parts give us:
    \[\diff{w}{t} = 2[uu_x]_0^\ell - 2\int_0^\ell u_x^2\ dx = - 2\int_0^\ell u_x^2\ dx\]
    where the last equality is due to the given boundary conditions $u(0,t)=u(\ell,t)=0$. Clealry $- 2\int_0^\ell u_x^2\ dx$ is non-positive. We claim that it is non-zero. If not, then $u_x=0$ implies that $u$ is a constant. Since $u(0,t)=0$, so $u$ is a zero function. But we have shown that $u(x,t)>0$, thus contradiction, implying that the integral is non-zero. Therefore
    \[\diff{w}{t}=- 2\int_0^\ell u_x^2\ dx <0\]
\end{ex}